<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Noise Points" href="noise-points.html" /><link rel="prev" title="A Framework for Benchmarking Clustering Algorithms" href="../index.html" />
        <link rel="canonical" href="https://clustering-benchmarks.gagolewski.com/weave/true-vs-predicted.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.2.5 and Furo 2023.08.19 -->
        <title>True vs Predicted Clusters - Clustering Benchmarks</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=b4e99bb3" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Clustering Benchmarks</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">

<span class="sidebar-brand-text">
<a class="sidebar-brand" href="../index.html">Clustering Benchmarks</a>
</span>
<div class="sidebar-brand">
1.1.2
</div>
<form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Methodology</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">True vs Predicted Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise-points.html">Noise Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="many-partitions.html">There Can Be Many Valid Partitions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Benchmark Batteries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="suite-v1.html">Benchmark Suite (v1.1.0)</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-v1.html">Explore Datasets (v1.1.0)</a></li>
<li class="toctree-l1"><a class="reference internal" href="results-v1.html">Clustering Results Repository (v1.1.0)</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-format.html">File Format Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to-access.html">Access from Python, R, MATLAB, etc.</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="clustbench-usage.html">Using <em>clustbench</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../clustbench-documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/clustering-benchmarks">Source Code (GitHub)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/clustering-benchmarks">PyPI Entry</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">See Also</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com/">Author's Homepage</a></li>
<li class="toctree-l1"><a class="reference external" href="https://datawranglingpy.gagolewski.com/">Data Wrangling in Python</a></li>
<li class="toctree-l1"><a class="reference external" href="https://deepr.gagolewski.com">Deep R Programming</a></li>
<li class="toctree-l1"><a class="reference external" href="https://genieclust.gagolewski.com/">genieclust Package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="colouriser.html">Colouriser: A Planar Data Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-validity-measures.html">External Cluster Validity Measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal-validity-measures.html">Side Note: Internal <em>(In)Validity</em> Measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../z_bibliography.html">References</a></li>
</ul>

</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/gagolews/clustering-benchmarks//issues/" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="true-vs-predicted-clusters">
<span id="sec-true-vs-predicted"></span><h1>True vs Predicted Clusters<a class="headerlink" href="#true-vs-predicted-clusters" title="Link to this heading">#</a></h1>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(X=\{\mathbf{x}_1, \dots, \mathbf{x}_n\}\)</span> be a <strong>benchmark dataset</strong>
that consists of <span class="math notranslate nohighlight">\(n\)</span> objects.</p>
<p>As an illustration, in this section, we consider
the <a class="reference internal" href="suite-v1.html#sec-suite-v1"><span class="std std-ref">wut/x2</span></a> dataset, which features 120 points in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">clustbench</span>
<span class="n">data_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/gagolews/clustering-data-v1/raw/v1.1.0&quot;</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">clustbench</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;wut&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">data_url</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">data</span>
<span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># preview</span>
<span class="c1">## array([[-0.16911746, -0.25135197],</span>
<span class="c1">##        [-0.17667309, -0.48302249],</span>
<span class="c1">##        [-0.1423283 , -0.36194485],</span>
<span class="c1">##        [-0.10637601, -0.70068834],</span>
<span class="c1">##        [-0.49353012, -0.23587515]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python code we give here should be self-explanatory even to
the readers who do not know this language (yet<a class="footnote-reference brackets" href="#footbook" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>).
Also note that in a <a class="reference internal" href="how-to-access.html#sec-how-to-access"><span class="std std-ref">further section</span></a>,
we explain how to use our benchmark framework from within R and MATLAB.</p>
</div>
</section>
<section id="reference-labels">
<h2>Reference Labels<a class="headerlink" href="#reference-labels" title="Link to this heading">#</a></h2>
<p>Each benchmark dataset is equipped with a <strong>reference<a class="footnote-reference brackets" href="#footmanyreference" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>
partition</strong> assigned by experts, which
represents a grouping of the points into <span class="math notranslate nohighlight">\(k \ge 2\)</span> clusters,
or, more formally, a <em>k</em>-partition<a class="footnote-reference brackets" href="#footpart" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> <span class="math notranslate nohighlight">\(\{X_1,\dots,X_k\}\)</span> of <span class="math notranslate nohighlight">\(X\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">y_true</span> <span class="o">:=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># the first label vector</span>
<span class="c1">## array([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,</span>
<span class="c1">##        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1,</span>
<span class="c1">##        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,</span>
<span class="c1">##        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,</span>
<span class="c1">##        1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,</span>
<span class="c1">##        3, 3, 3, 3, 3, 3, 3, 3, 3, 3])</span>
</pre></div>
</div>
<p>More precisely, what we have here is a <strong>label vector</strong>
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span>, where <span class="math notranslate nohighlight">\(y_i\in\{1,\dots,k\}\)</span> gives the subset/cluster number
(ID) of the <em>i</em>-th object.</p>
<p>The number of subsets, <em>k</em>, is thus an inherent part of the
reference set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">k</span> <span class="o">:=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_true</span><span class="p">))</span>  <span class="c1"># or benchmark.n_clusters[0]</span>
<span class="c1">## 3</span>
</pre></div>
</div>
</section>
<section id="predicted-labels">
<h2>Predicted Labels<a class="headerlink" href="#predicted-labels" title="Link to this heading">#</a></h2>
<p>Let us take any <strong>partitional clustering algorithm whose quality
we would like to assess</strong>. As an example, we will consider the outputs
generated by <a class="reference external" href="https://genieclust.gagolewski.com"><em>Genie</em></a>.
We apply it on <span class="math notranslate nohighlight">\(X\)</span> to <strong>discover a new <em>k</em>-partition</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">genieclust</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">genieclust</span><span class="o">.</span><span class="n">Genie</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>  <span class="c1"># using default parameters</span>
<span class="p">(</span><span class="n">y_pred</span> <span class="o">:=</span> <span class="n">g</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># +1 makes cluster IDs in 1..k, not 0..(k-1)</span>
<span class="c1">## array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,</span>
<span class="c1">##        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1,</span>
<span class="c1">##        2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 3, 2, 2, 2, 2, 2, 1,</span>
<span class="c1">##        2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2,</span>
<span class="c1">##        2, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,</span>
<span class="c1">##        3, 3, 3, 3, 3, 3, 3, 3, 3, 3])</span>
</pre></div>
</div>
<p>We thus obtained a vector of <strong>predicted labels</strong>
encoding a new grouping, <span class="math notranslate nohighlight">\(\{\hat{X}_1,\dots,\hat{X}_k\}\)</span>.
We will denote it by <span class="math notranslate nohighlight">\(\hat{\mathbf{y}}\)</span>.</p>
<p>The figure below depicts the two partitions side by side.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">genieclust</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">y_true</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y_true&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">genieclust</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">y_pred</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y_pred&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id8">
<span id="fig-partition-similarity-example-2"></span><img alt="../_images/partition-similarity-example-2-1.png" src="../_images/partition-similarity-example-2-1.png" />
<figcaption>
<p><span class="caption-number">Figure 1:  </span><span class="caption-text">Two example partitions that we would like to compare. Intuitively, clustering can be considered as a method to assign colours to all the input points.</span><a class="headerlink" href="#id8" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Ideally, we would like to work with algorithms that yield partitions
closely matching the reference ones. This should be true on as wide
a set of problems as possible.</p>
</div>
<p>We, therefore, need to <em>relate</em> the predicted labels to the reference ones.
Note that the automated discovery of <span class="math notranslate nohighlight">\(\hat{\mathbf{y}}\)</span>
never relies on the information included in <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>
(except for the cluster count, <span class="math notranslate nohighlight">\(k\)</span>).
In other words, clustering is an unsupervised<a class="footnote-reference brackets" href="#footsemisupervised" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>
learning process.</p>
</section>
<section id="permuting-cluster-ids">
<h2>Permuting Cluster IDs<a class="headerlink" href="#permuting-cluster-ids" title="Link to this heading">#</a></h2>
<p>A partition is a <em>set</em> of point groups, and sets are, by definition, unordered.
Therefore, the <strong>actual cluster IDs do not matter</strong>.
Looking at the above figure, we see that
the red (ID=2), black (ID=1), and green (ID=3) predicted clusters
can be paired with, respectively,
the black (ID=1), red (ID=2), and green (ID=3) reference ones.
We can easily recode<a class="footnote-reference brackets" href="#footmanualrelabel" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> <code class="docutils literal notranslate"><span class="pre">y_pred</span></code>
so that the cluster IDs correspond to each other:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># relabelling: 1→2, 2→1, 3→3</span>
<span class="p">(</span><span class="n">y_pred</span> <span class="o">:=</span> <span class="n">o</span><span class="p">[</span><span class="n">y_pred</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Python uses 0-based indexing, hence the -1</span>
<span class="c1">## array([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,</span>
<span class="c1">##        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2,</span>
<span class="c1">##        1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 2, 1, 3, 1, 1, 1, 1, 1, 2,</span>
<span class="c1">##        1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1,</span>
<span class="c1">##        1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,</span>
<span class="c1">##        3, 3, 3, 3, 3, 3, 3, 3, 3, 3])</span>
</pre></div>
</div>
<p>See below for an updated figure.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">genieclust</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">y_true</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y_true&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">genieclust</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">y_pred</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y_pred&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id9">
<span id="fig-partition-similarity-example-2b"></span><img alt="../_images/partition-similarity-example-2b-3.png" src="../_images/partition-similarity-example-2b-3.png" />
<figcaption>
<p><span class="caption-number">Figure 2:  </span><span class="caption-text">The two partitions after the cluster ID (colour) matching.</span><a class="headerlink" href="#id9" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="confusion-matrix">
<h2>Confusion Matrix<a class="headerlink" href="#confusion-matrix" title="Link to this heading">#</a></h2>
<p>We can determine the confusion matrix <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> for the two label vectors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genieclust</span><span class="o">.</span><span class="n">compare_partitions</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="c1">## array([[37, 12,  1],</span>
<span class="c1">##        [ 0, 40,  0],</span>
<span class="c1">##        [ 0,  0, 30]])</span>
</pre></div>
</div>
<p>Here, the value in the <span class="math notranslate nohighlight">\(i\)</span>-th row and the <span class="math notranslate nohighlight">\(j\)</span>-to column,
<span class="math notranslate nohighlight">\(c_{i, j}\)</span>, denotes the number of points in the <span class="math notranslate nohighlight">\(i\)</span>-th reference cluster
that the algorithm assigned to the <span class="math notranslate nohighlight">\(j\)</span>-th cluster.</p>
<p>Overall, <em>Genie</em> returned a clustering quite similar to the reference one.
We may consider 107 (namely, <span class="math notranslate nohighlight">\(c_{1,1}+c_{2,2}+c_{3,3}=37+40+30\)</span>) out of the 120
input points as correctly grouped. In particular, all the red and
green reference points (the 2nd and the 3rd row) have been
properly discovered.</p>
<p>However, the algorithm has miscategorised (at least, as far as the current
set of expert labels is concerned) one green and twelve red points.
They should have been coloured black.</p>
</section>
<section id="external-cluster-validity-measures">
<h2>External Cluster Validity Measures<a class="headerlink" href="#external-cluster-validity-measures" title="Link to this heading">#</a></h2>
<p>A confusion matrix summarises all the information required
to judge the similarity between the two partitions. However,
if we wish to compare the quality of different algorithms,
we would rather have it summarised in the form of a single number.</p>
<p>Following <span id="id6">[<a class="reference internal" href="../z_bibliography.html#id4" title="Gagolewski, M. (2023).  Normalised clustering accuracy: An asymmetric external cluster validity measure. under review (preprint). URL: https://arxiv.org/pdf/2209.02935.pdf, DOI: 10.48550/arXiv.2209.02935.">24</a>]</span>, we recommend the use of the
<strong>normalised clustering accuracy</strong> (NCA) as an <em>external cluster validity measure</em>
which quantifies the degree of agreement between the reference <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> and
the predicted <span class="math notranslate nohighlight">\(\hat{\mathbf{y}}\)</span>. It is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\mathrm{NCA}(\mathbf{C})
=
\displaystyle\max_{\sigma:\{1,\dots,k\}\stackrel{\text{1--1}}{\to}\{1,\dots,k\}}
\frac{1}{k} \displaystyle\sum_{j=1}^{k} \frac{
    c_{\sigma(j),j}
    -
    \frac{1}{k} c_{\sigma(j),j}
}{
    c_{\sigma(j),\cdot}-\frac{1}{k} c_{\sigma(j),\cdot}
}.
\]</div>
</div>
<p>NCA is the averaged percentage of correctly classified
points in each cluster <em>above</em> the perfectly uniform label distribution.
Note that the matching between the cluster labels is performed
automatically by finding the best permutation <span class="math notranslate nohighlight">\(\sigma\)</span>
of the set <span class="math notranslate nohighlight">\(\{1,\dots,k\}\)</span>.</p>
<p>Overall, the more similar the partitions, the greater the similarity score.
Two identical clusterings yield the value of 1.
NCA is normalised: it is equal to 0 if the cluster memberships are evenly spread
or all the points were put into a single large cluster. In our case:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genieclust</span><span class="o">.</span><span class="n">compare_partitions</span><span class="o">.</span><span class="n">normalized_clustering_accuracy</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="c1">## 0.8700000000000001</span>
</pre></div>
</div>
<p>or, equivalently:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clustbench</span><span class="o">.</span><span class="n">get_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>  <span class="c1"># the NCA metric is used by default</span>
<span class="c1">## 0.8700000000000001</span>
</pre></div>
</div>
<p>This value indicates a decent degree of similarity between the reference
and the discovered partitions.</p>
<p>Other popular partition similarity scores, e.g., the adjusted
Rand index or normalised mutual information, are discussed
in the <a class="reference internal" href="external-validity-measures.html#sec-external-validity-measures"><span class="std std-ref">Appendix</span></a>.
In particular, this is where we argue why the classic (classification)
accuracy rate should not be used in our context (this is a common mistake!).</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footbook" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Check out Marek’s open-access (free!) textbook
<a class="reference external" href="https://datawranglingpy.gagolewski.com/">Minimalist Data Wrangling in Python</a>
<span id="id7">[<a class="reference internal" href="../z_bibliography.html#id8" title="Gagolewski, M. (2022).  Minimalist Data Wrangling with Python. Zenodo, Melbourne. ISBN 978-0-6455719-1-2. URL: https://datawranglingpy.gagolewski.com/, DOI: 10.5281/zenodo.6451068.">22</a>]</span>.</p>
</aside>
<aside class="footnote brackets" id="footmanyreference" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference internal" href="many-partitions.html#sec-many-partitions"><span class="std std-ref">Later</span></a> we will note
that there may be many equally valid ways to split a dataset into groups.</p>
</aside>
<aside class="footnote brackets" id="footpart" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>We say that <span class="math notranslate nohighlight">\(\{X_1,\dots,X_k\}\)</span> is a <span class="math notranslate nohighlight">\(k\)</span>-partition of <span class="math notranslate nohighlight">\(X\)</span>,
whenever <span class="math notranslate nohighlight">\(\bigcup_{i=1}^k X_i=X\)</span>, each <span class="math notranslate nohighlight">\(X_i\)</span> is nonempty,
and the subsets are pairwise disjoint, i.e., <span class="math notranslate nohighlight">\(X_i\cap X_j=\emptyset\)</span>
for <span class="math notranslate nohighlight">\(i\neq j\)</span>.</p>
</aside>
<aside class="footnote brackets" id="footsemisupervised" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>Tasks such as semi-supervised clustering,
where the right assignment of <em>some</em> of the input points is known in
advance, are not of our interest here. However, the current framework can
trivially be adjusted to fit such scenarios.</p>
</aside>
<aside class="footnote brackets" id="footmanualrelabel" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p>In a
<a class="reference internal" href="external-validity-measures.html#sec-external-validity-measures"><span class="std std-ref">later section</span></a>,
we discuss a way to automatically discover an optimal relabelling
based on the solution to the maximal assignment problem.</p>
</aside>
</aside>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="noise-points.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Noise Points</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              
              
              Copyright &#169; 2020–2023 by <a href="https://www.gagolewski.com">Marek Gagolewski</a>.
              Some rights reserved. Licensed under <a href='https://creativecommons.org/licenses/by-nc-nd/4.0/'>CC BY-NC-ND 4.0</a>.
              Built with <a href="https://sphinx-doc.org/">Sphinx</a>
              and a customised <a href="https://github.com/pradyunsg/furo">Furo</a> theme.
              Last updated on 2023-10-26T14:38:08+1100.
              This site will never display any ads: it is a non-profit project.
              It does not collect any data.
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            In this section
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">True vs Predicted Clusters</a><ul>
<li><a class="reference internal" href="#data">Data</a></li>
<li><a class="reference internal" href="#reference-labels">Reference Labels</a></li>
<li><a class="reference internal" href="#predicted-labels">Predicted Labels</a></li>
<li><a class="reference internal" href="#permuting-cluster-ids">Permuting Cluster IDs</a></li>
<li><a class="reference internal" href="#confusion-matrix">Confusion Matrix</a></li>
<li><a class="reference internal" href="#external-cluster-validity-measures">External Cluster Validity Measures</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=6f037312"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>